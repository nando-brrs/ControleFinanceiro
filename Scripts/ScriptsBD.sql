CREATE DATABASE ControleFinanceiro

USE [ControleFinanceiro]

CREATE TABLE [USUARIOS]
(
	[ID] UNIQUEIDENTIFIER NOT NULL,
	[NOME] VARCHAR(150) NOT NULL,
	[EMAIL] VARCHAR(100) NOT NULL,
	[LOGIN] VARCHAR(50) NOT NULL,
	[SENHA] VARCHAR(100) NOT NULL,
	[ATIVO] BIT NOT NULL,
	CONSTRAINT PK_USUARIOS_ID
		PRIMARY KEY CLUSTERED (ID)
);


CREATE TABLE [TIPOLANCAMENTOS]
(
	[ID] INT NOT NULL,
	[DESCRICAO] VARCHAR(200)
	CONSTRAINT PK_TIPOLANCAMENTOS_ID
		PRIMARY KEY CLUSTERED (ID)
);


INSERT INTO [TIPOLANCAMENTOS](ID, DESCRICAO) VALUES(1, 'RECEITAS')
INSERT INTO [TIPOLANCAMENTOS](ID, DESCRICAO) VALUES(2, 'DESPESAS')

CREATE TABLE [CATEGORIAS]
(
	[ID] UNIQUEIDENTIFIER NOT NULL,
	[DESCRICAO] VARCHAR(200),
	[ATIVO] BIT NOT NULL,
	[ID_TIPOLANCAMENTO] INT NOT NULL,
	CONSTRAINT PK_CATEGORIAS_ID	
		PRIMARY KEY CLUSTERED (ID)
);

Alter Table [CATEGORIAS] WITH CHECK ADD CONSTRAINT [FK_CATEGORIA_TIPOLANCAMENTO]
FOREIGN KEY ([ID_TIPOLANCAMENTO]) REFERENCES [TIPOLANCAMENTOS]([ID])


INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Receitas', 1, 1)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Alimentação', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Habitação', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Comunicação', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Educação', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Transporte', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Lazer', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Pessoal', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Saúde', 1, 2)
INSERT INTO [CATEGORIAS](ID, DESCRICAO, ATIVO, ID_TIPOLANCAMENTO) VALUES(NEWID(), 'Serviços Financeiros', 1, 2)


CREATE TABLE [SUBCATEGORIAS]
(
	[ID] UNIQUEIDENTIFIER NOT NULL,
	[DESCRICAO] VARCHAR(200),
	[ATIVO] BIT NOT NULL,
	[ID_CATEGORIA] UNIQUEIDENTIFIER NOT NULL,
	CONSTRAINT PK_SUBCATEGORIAS_ID	
		PRIMARY KEY CLUSTERED (ID)
);

Alter Table [SUBCATEGORIAS] WITH CHECK ADD CONSTRAINT [FK_SUBCATEGORIA_CATEGORIA]
FOREIGN KEY ([ID_CATEGORIA]) REFERENCES [CATEGORIAS]([ID])



INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Salário', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Receitas'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Férias', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Receitas'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), '13º Salário', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Receitas'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Outras Receitas', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Receitas'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Feira/hortifruti', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Alimentação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Supermercado', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Alimentação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'açougue', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Alimentação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Padaria', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Alimentação'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Água/esgoto', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Habitação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Eletricidade', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Habitação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Gás', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Habitação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Manutenção da casa', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Habitação'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Telefone', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Comunicação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Internet', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Comunicação'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Curso idioma', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Educação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Mensalidade', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Educação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Material', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Educação'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Atividades extra-curriculares', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Educação'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Combustível', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Estacionamento', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'IPVA', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Taxa Licenciamento', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'DPVAT', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Manutenção', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Metrô/ônibus/trem', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Seguro carro', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Prestação carro', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Transporte'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'TV a cabo', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Cinema', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Barzinho/Pizzaria', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Teatro', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Viagens', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Leitura', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Lazer'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Cabeleireiro', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Pessoal'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Manicure', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Pessoal'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Academia/esportes', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Pessoal'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Vestuário', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Pessoal'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Presentes', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Pessoal'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Remédios', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Saúde'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Dentista', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Saúde'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Outros', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Saúde'))

INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Tarifa banco', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Serviços Financeiros'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Fatura Cartão', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Serviços Financeiros'))
INSERT INTO [SUBCATEGORIAS](ID, DESCRICAO, ATIVO, ID_CATEGORIA) VALUES(NEWID(), 'Investimentos', 1, (SELECT ID FROM CATEGORIAS WHERE DESCRICAO LIKE 'Serviços Financeiros'))

CREATE TABLE [LANCAMENTOS]
(
	[ID] UNIQUEIDENTIFIER NOT NULL,
	[VALOR] DECIMAL NOT NULL,
	[DATA] DATETIME NOT NULL,
	[DATAVENCIMENTO] DATE NULL,
	[PAGO] BIT NULL,
	[RECORRENTE] BIT NULL,
	[DESCRICAO] VARCHAR(500) NULL,
	[ID_TIPOLANCAMENTO] INT NOT NULL,
	[ID_SUBCATEGORIA] UNIQUEIDENTIFIER NOT NULL,
	[ID_USUARIO] UNIQUEIDENTIFIER NOT NULL,
	CONSTRAINT PK_LANCAMENTOS_ID	
		PRIMARY KEY CLUSTERED (ID)
);

Alter Table [LANCAMENTOS] WITH CHECK ADD CONSTRAINT [FK_LANCAMENTOS_SUBCATEGORIA]
FOREIGN KEY ([ID_SUBCATEGORIA]) REFERENCES [SUBCATEGORIAS]([ID])

Alter Table [LANCAMENTOS] WITH CHECK ADD CONSTRAINT [FK_LANCAMENTOS_TIPOLANCAMENTO]
FOREIGN KEY ([ID_TIPOLANCAMENTO]) REFERENCES [TIPOLANCAMENTOS]([ID])

Alter Table [LANCAMENTOS] WITH CHECK ADD CONSTRAINT [FK_LANCAMENTOS_USUARIO]
FOREIGN KEY ([ID_USUARIO]) REFERENCES [USUARIOS]([ID])

